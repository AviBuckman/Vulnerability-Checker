
import mysql.connector

db = mysql.connector.connect(host='localhost', user='root', passwd='root')
cursor = db.cursor()
cursor.execute("CREATE DATABASE IF NOT EXISTS vulnerableDB")
cursor.close()
db.close()

db = mysql.connector.connect(host='localhost', user='root', passwd='root', database='vulnerableDB')
mycursor = db.cursor()

mycursor.execute("CREATE TABLE IF NOT EXISTS vulnerableTBL (package VARCHAR(255), full_path VARCHAR(255),directory VARCHAR(255),file_name VARCHAR(255), file_info_output VARCHAR(255), md5 VARCHAR(255), sha1 VARCHAR(255), sha256 VARCHAR(255), strings VARCHAR(255), readelf VARCHAR(255), vulnerable_functions VARCHAR(255), secret_keys VARCHAR(255))")

sql = "INSERT INTO vulnerableTBL (package,full_path,directory,file_name,file_info_output,md5,sha1,sha256,
strings,readelf ,vulnerable_functions,secert_keys) VALUES (%s, %s)"
val = []
#package name - from dpkg
#full path
#directory- split path
#file info output - output from file()
#md5,sha1, sha256- hash the file
#strings - output of strings command
#readelf - output (if relevant)
#vulnerable_func ()

mycursor.executemany(sql, val)

db.commit()
mycursor.close()
db.close()


# function that takes input and inserts in table
