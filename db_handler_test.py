
import mysql.connector

db = mysql.connector.connect(host='localhost', user='root', passwd='root')
cursor = db.cursor()
cursor.execute("CREATE DATABASE IF NOT EXISTS vulnerableDB")
cursor.close()
db.close()

db = mysql.connector.connect(host='localhost', user='root', passwd='root', database='vulnerableDB')
mycursor = db.cursor()

mycursor.execute("CREATE TABLE IF NOT EXISTS vulnerableTBL (package VARCHAR(255), full_path VARCHAR(255),directory VARCHAR(255),file_name VARCHAR(255), file_info_output VARCHAR(255), md5 VARCHAR(255), sha1 VARCHAR(255), sha256 VARCHAR(255), strings VARCHAR(255), readelf VARCHAR(255), vulnerable_functions VARCHAR(255), secret_keys VARCHAR(255))")
db.commit()

def insert_DB(Values):

    sql = """INSERT INTO vulnerableTBL 
    VALUES ( %s , %s ,  %s ,  %s ,  %s ,  %s ,  %s ,  %s ,  %s ,  %s ,  %s ,  %s ) """

    sql = "INSERT INTO vulnerableTBL (package, full_path ,directory ,file_name , file_info_output , md5 , sha1 , sha256 , strings , readelf , vulnerable_functions, secret_keys ) VALUES ( "
    for word in Values:
        sql = sql + word + ", " 
    sql+=")"
    mycursor.execute(sql , Values)

    db.commit()
    return True

val = ["data"]*12
insert_DB(val)

for row in mycursor.fetchall():
    print(row)

mycursor.close()
db.close()

