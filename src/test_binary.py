import os
from file_scanner import FileScanner
from defs import *
file_scanner: FileScanner = FileScanner(
    VUL_FUNC_PATH, STRINGS_PATH)


def test_vulnerable_function_basic():
    path = os.path.abspath("src/unit_test_files/test1/test1")
    output = file_scanner.scan_binary(path)
    assert output[VULNERABLE_FUNC] == "{'gets'}"


def test_nonvulnerable_version():
    path = os.path.abspath("src/unit_test_files/test2/test2")
    output = file_scanner.scan_binary(path)
    assert output[VULNERABLE_FUNC] == ""


def test_user_defined_identical():
    path = os.path.abspath("src/unit_test_files/test3/test3")
    output = file_scanner.scan_binary(path)
    assert output[VULNERABLE_FUNC] == ""
