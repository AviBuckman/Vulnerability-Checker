from CSV_handler import CSVHandler, DataHandler
from checker import Checker
import csv
import itertools

def main():
    data_handler: DataHandler = CSVHandler()
    checker: Checker = Checker(data_handler)

    #change the labs names
    libs=[{'name': 'accountsservice', 'version': '0.6.45-1ubuntu1', 'architecture': 'amd64'},
 {'name': 'acl', 'version': '2.2.52-3build1', 'architecture': 'amd64'},
 {'name': 'acpid', 'version': '1:2.0.28-1ubuntu1', 'architecture': 'amd64'}]
    checker.scan_library_list(checker,libs)

    #change the file name
    #vulnerability table:
    reader1 = csv.reader("realOutput_vul")
    reader2 = csv.reader("vulnerability.csv")

    for lhs, rhs in itertools.izip(reader1, reader2):
        if lhs != rhs:
           return False
    #strings table:
    reader1 = csv.reader("realOutput_strings")
    reader2 = csv.reader("strings.csv")

    for lhs, rhs in itertools.izip(reader1, reader2):
        if lhs != rhs:
           return False
    return True
