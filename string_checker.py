import glob, os, sys, subprocess,re
from csv import reader

def findKeyWordsInFile(path,secretKeysList):
    txt= open(path)
    found = set()
    for line in txt:
        for func_word in secretKeysList:
            if re.search(func_word , line, re.IGNORECASE):
                found.add(func_word)
    return found

def loadKeysFromCsv():
    with open('secretKeys.csv', 'r') as read_obj:
        csv_reader = reader(read_obj)
        list_of_rows = list(csv_reader)
        return list(map(lambda x: x[0], list_of_rows))


def txtFileChecker(pathsList):
    secretKeysList = loadKeysFromCsv()
    file_dict={}
    for path in pathsList:
        temp_path = "temp.txt"
        strings_command = ' strings ' + path + ' > ' + temp_path
        subprocess.call(strings_command, shell=True)
        foundKeys= findKeyWordsInFile(temp_path, secretKeysList)
        if foundKeys:
            file_dict[path] = foundKeys
        subprocess.call("rm temp.txt", shell=True)
    return file_dict


pathList={'/home/ise/one.txt','/home/ise/key.pem'}
print(txtFileChecker(pathList))